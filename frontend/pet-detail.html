<!DOCTYPE html>
<html lang="uz">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hayvon - Pet Tashkent</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>

<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="sticky top-0 z-50 bg-white/80 backdrop-blur border-b">
        <div class="max-w-7xl mx-auto px-4 h-16 flex items-center justify-between">
            <a href="/" class="flex items-center gap-2">
                <span class="text-2xl">üêæ</span>
                <span
                    class="font-bold text-xl bg-gradient-to-r from-orange-500 to-pink-500 bg-clip-text text-transparent">Pet
                    Tashkent</span>
            </a>
            <div class="hidden md:flex gap-8">
                <a href="/" class="text-gray-600 hover:text-orange-500">Bosh sahifa</a>
                <a href="pets.html" class="text-orange-500 font-semibold">Hayvonlar</a>
                <a href="clinics.html" class="text-gray-600 hover:text-orange-500">Veterinarlar</a>
                <a href="donation.html" class="text-gray-600 hover:text-orange-500">Xayriya</a>
            </div>
        </div>
    </nav>

    <main class="max-w-6xl mx-auto px-4 py-8">
        <!-- Loading State -->
        <div id="loading" class="text-center py-20">
            <div class="text-4xl mb-4 animate-bounce">üêæ</div>
            <p class="text-gray-500">Yuklanmoqda...</p>
        </div>

        <!-- Pet Details -->
        <div id="petDetails" class="hidden">
            <div class="grid lg:grid-cols-2 gap-8">
                <!-- Image -->
                <div class="bg-white rounded-3xl shadow-lg overflow-hidden">
                    <img id="petImage" src="" alt="" class="w-full h-96 object-cover">
                    <div class="p-4 flex gap-2">
                        <span id="petBadge" class="px-3 py-1 rounded-full text-sm font-medium"></span>
                        <span id="petType" class="px-3 py-1 bg-gray-100 rounded-full text-sm"></span>
                    </div>
                </div>

                <!-- Info -->
                <div class="bg-white rounded-3xl shadow-lg p-8">
                    <div class="flex items-start justify-between mb-6">
                        <div>
                            <h1 id="petName" class="text-3xl font-bold mb-2"></h1>
                            <p id="petBreed" class="text-gray-500"></p>
                        </div>
                        <p id="petPrice" class="text-2xl font-bold text-orange-500"></p>
                    </div>

                    <div class="grid grid-cols-2 gap-4 mb-6">
                        <div class="bg-gray-50 rounded-xl p-4">
                            <p class="text-gray-500 text-sm">Yoshi</p>
                            <p id="petAge" class="font-semibold">-</p>
                        </div>
                        <div class="bg-gray-50 rounded-xl p-4">
                            <p class="text-gray-500 text-sm">Jinsi</p>
                            <p id="petGender" class="font-semibold">-</p>
                        </div>
                        <div class="bg-gray-50 rounded-xl p-4">
                            <p class="text-gray-500 text-sm">Joylashuv</p>
                            <p id="petLocation" class="font-semibold">-</p>
                        </div>
                        <div class="bg-gray-50 rounded-xl p-4">
                            <p class="text-gray-500 text-sm">Ko'rishlar</p>
                            <p id="petViews" class="font-semibold">0</p>
                        </div>
                    </div>

                    <div class="mb-6">
                        <h3 class="font-semibold mb-2">Tavsif</h3>
                        <p id="petDescription" class="text-gray-600">Tavsif mavjud emas</p>
                    </div>

                    <div class="border-t pt-6">
                        <h3 class="font-semibold mb-4">Egasi bilan bog'lanish</h3>
                        <div id="ownerInfo" class="flex items-center gap-4 mb-4">
                            <div class="w-12 h-12 bg-gradient-to-br from-orange-400 to-pink-500 rounded-full flex items-center justify-center text-white font-bold"
                                id="ownerAvatar">?</div>
                            <div>
                                <p id="ownerName" class="font-semibold">-</p>
                                <p id="ownerPhone" class="text-sm text-gray-500">-</p>
                            </div>
                        </div>
                        <div class="flex gap-3">
                            <a id="phoneLink" href="tel:"
                                class="flex-1 py-3 bg-green-500 text-white text-center rounded-xl font-semibold hover:bg-green-600">
                                üìû Qo'ng'iroq qilish
                            </a>
                            <a id="telegramLink" href="#"
                                class="flex-1 py-3 bg-blue-500 text-white text-center rounded-xl font-semibold hover:bg-blue-600">
                                ‚úàÔ∏è Telegram
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Not Found -->
        <div id="notFound" class="hidden text-center py-20">
            <div class="text-6xl mb-4">üòî</div>
            <h2 class="text-2xl font-bold mb-2">Hayvon topilmadi</h2>
            <p class="text-gray-500 mb-6">Bu e'lon mavjud emas yoki o'chirilgan</p>
            <a href="pets.html" class="px-6 py-3 bg-orange-500 text-white rounded-xl font-semibold hover:bg-orange-600">
                Hayvonlarga qaytish
            </a>
        </div>
    </main>

    <script src="js/main.js"></script>
    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const petId = urlParams.get('id');

        if (!petId) {
            showNotFound();
        } else {
            loadPetDetails(petId);
        }

        async function loadPetDetails(id) {
            try {
                const res = await fetch(`${API_BASE}/api/pets/${id}`);
                if (!res.ok) throw new Error('Not found');

                const data = await res.json();
                displayPet(data.pet);
            } catch (e) {
                showNotFound();
            }
        }

        function displayPet(pet) {
            document.getElementById('loading').classList.add('hidden');
            document.getElementById('petDetails').classList.remove('hidden');

            // Set title
            document.title = `${pet.name} - Pet Tashkent`;

            // Image
            const img = document.getElementById('petImage');
            if (pet.image) {
                img.src = `${API_BASE}/static/uploads/${pet.image}`;
            } else {
                img.src = getPlaceholderImage(pet.pet_type);
            }
            img.alt = pet.name;

            // Badge
            const badge = document.getElementById('petBadge');
            const statusMap = {
                'selling': { text: 'Sotiladi', class: 'bg-blue-100 text-blue-700' },
                'free': { text: 'Bepul', class: 'bg-green-100 text-green-700' },
                'foster': { text: 'Foster', class: 'bg-purple-100 text-purple-700' },
                'adoption': { text: 'Adoptsiya', class: 'bg-pink-100 text-pink-700' }
            };
            const st = statusMap[pet.status] || { text: pet.status, class: 'bg-gray-100 text-gray-700' };
            badge.textContent = st.text;
            badge.className = `px-3 py-1 rounded-full text-sm font-medium ${st.class}`;

            // Type
            const typeMap = { 'dog': 'üêï It', 'cat': 'üêà Mushuk', 'bird': 'ü¶ú Qush', 'fish': 'üê† Baliq' };
            document.getElementById('petType').textContent = typeMap[pet.pet_type] || pet.pet_type;

            // Info
            document.getElementById('petName').textContent = pet.name;
            document.getElementById('petBreed').textContent = pet.breed || 'Zoti ko\'rsatilmagan';
            document.getElementById('petPrice').textContent = pet.price > 0 ? formatPrice(pet.price) : 'Bepul';
            document.getElementById('petAge').textContent = pet.age || '-';
            document.getElementById('petGender').textContent = pet.gender === 'male' ? 'Erkak' : pet.gender === 'female' ? 'Urg\'ochi' : '-';
            document.getElementById('petLocation').textContent = pet.location || 'Toshkent';
            document.getElementById('petViews').textContent = pet.views || 0;
            document.getElementById('petDescription').textContent = pet.description || 'Tavsif mavjud emas';

            // Owner
            if (pet.owner) {
                document.getElementById('ownerAvatar').textContent = pet.owner.full_name?.charAt(0) || '?';
                document.getElementById('ownerName').textContent = pet.owner.full_name || 'Noma\'lum';
                document.getElementById('ownerPhone').textContent = pet.owner.phone || '';
                document.getElementById('phoneLink').href = `tel:${pet.owner.phone || ''}`;
            }
        }

        function getPlaceholderImage(type) {
            const placeholders = {
                'dog': 'https://images.unsplash.com/photo-1587300003388-59208cc962cb?w=600',
                'cat': 'https://images.unsplash.com/photo-1514888286974-6c03e2ca1dba?w=600',
                'bird': 'https://images.unsplash.com/photo-1552728089-57bdde30beb3?w=600',
                'fish': 'https://images.unsplash.com/photo-1522069169874-c58ec4b76be5?w=600'
            };
            return placeholders[type] || placeholders.dog;
        }

        function showNotFound() {
            document.getElementById('loading').classList.add('hidden');
            document.getElementById('notFound').classList.remove('hidden');
        }
    </script>
</body>

</html>